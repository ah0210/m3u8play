var t,e,r=Object.getOwnPropertyNames,s=(t={"js/storage.Dq-Abjh4.js"(t,e){class r{constructor(){this.dbName="videoPlayerDB",this.storeName="playHistory",this.dbVersion=1,this.db=null}async openDB(){return new Promise((t,e)=>{if(this.db)return void t(this.db);const r=indexedDB.open(this.dbName,this.dbVersion);r.onupgradeneeded=t=>{if(this.db=t.target.result,!this.db.objectStoreNames.contains(this.storeName)){const t=this.db.createObjectStore(this.storeName,{keyPath:"url",autoIncrement:!1});t.createIndex("date","date",{unique:!1}),t.createIndex("playCount","playCount",{unique:!1})}},r.onsuccess=e=>{this.db=e.target.result,t(this.db)},r.onerror=t=>{e(t.target.error)}})}async saveRecord(t){try{const e=await this.openDB(),r=e.transaction(this.storeName,"readwrite").objectStore(this.storeName);await new Promise((e,s)=>{const o=r.put(t);o.onsuccess=e,o.onerror=s})}catch(e){throw e}}async getAllRecords(t={}){const{sortBy:e="date",sortOrder:r="desc",limit:s=120}=t;try{const t=(await this.openDB()).transaction(this.storeName,"readonly"),o=t.objectStore(this.storeName).index(e);return new Promise((t,e)=>{const n=[],a="asc"===r?"next":"prev",c=o.openCursor(null,a);c.onsuccess=e=>{const r=e.target.result;r&&n.length<s?(n.push(r.value),r.continue()):t(n)},c.onerror=e})}catch(o){return[]}}async getRecord(t){try{const e=await this.openDB(),r=e.transaction(this.storeName,"readonly").objectStore(this.storeName);return new Promise((e,s)=>{const o=r.get(t);o.onsuccess=t=>e(t.target.result),o.onerror=s})}catch(e){return null}}async deleteRecord(t){try{const e=await this.openDB(),r=e.transaction(this.storeName,"readwrite").objectStore(this.storeName);await new Promise((e,s)=>{const o=r.delete(t);o.onsuccess=e,o.onerror=s})}catch(e){throw e}}async clearAllRecords(){try{const t=await this.openDB(),e=t.transaction(this.storeName,"readwrite").objectStore(this.storeName);await new Promise((t,r)=>{const s=e.clear();s.onsuccess=t,s.onerror=r})}catch(t){throw t}}async getRecordCount(){try{const t=await this.openDB(),e=t.transaction(this.storeName,"readonly").objectStore(this.storeName);return new Promise((t,r)=>{const s=e.count();s.onsuccess=e=>t(e.target.result),s.onerror=r})}catch(t){return 0}}}const s=new r;void 0!==e&&e.exports?e.exports=r:window.playHistoryStorage=s}},function(){return e||(0,t[r(t)[0]])((e={exports:{}}).exports,e),e.exports});export default s();

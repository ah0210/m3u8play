import"./storage.UQ6rVsIW.js";import"./i18n.DqZjOawE.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let e=null,t=!1;window.i18n;const n={video:document.getElementById("video-player"),loadingMask:document.getElementById("loading-mask"),loadingText:document.getElementById("loading-text"),statusTip:document.getElementById("status-tip"),urlInput:document.getElementById("url-input"),urlClearBtn:document.getElementById("url-clear-btn"),fullscreenBtn:document.getElementById("fullscreen-btn"),pipBtn:document.getElementById("pip-btn"),screenshotBtn:document.getElementById("screenshot-btn"),shortcutBtn:document.getElementById("shortcut-btn"),clearCacheBtn:document.getElementById("clear-cache-btn"),helpBtn:document.getElementById("help-btn"),playlistBtn:document.getElementById("playlist-btn"),historyBtn:document.getElementById("history-btn"),historyPanel:document.getElementById("history-panel"),historyHeader:document.getElementById("history-header"),historyTitle:document.getElementById("historyTitle"),historyClear:document.getElementById("history-clear"),historyExport:document.getElementById("history-export"),historyImport:document.getElementById("history-import"),historyImportInput:document.getElementById("history-import-input"),historyBody:document.getElementById("history-body"),historyEmpty:document.getElementById("history-empty"),sortRecentBtn:document.getElementById("sort-recent"),sortHotBtn:document.getElementById("sort-hot"),alignLeftBtn:document.getElementById("align-left"),alignCenterBtn:document.getElementById("align-center"),alignRightBtn:document.getElementById("align-right"),volumeIcon:document.getElementById("volume-icon"),progressWrap:document.getElementById("progress-wrap"),progressBar:document.getElementById("progress-bar"),progressLoaded:document.getElementById("progress-loaded"),volumeSlider:document.getElementById("volume-slider"),speedSelect:document.getElementById("speed-select"),qualitySelect:document.getElementById("quality-select"),centerPlayBtn:document.getElementById("center-play-btn"),screenshotModal:document.getElementById("screenshot-modal"),screenshotImg:document.getElementById("screenshot-img"),screenshotClose:document.getElementById("screenshot-close"),screenshotDownload:document.getElementById("screenshot-download"),helpModal:document.getElementById("help-modal"),helpClose:document.getElementById("help-close"),playlistModal:document.getElementById("playlist-modal"),playlistClose:document.getElementById("playlist-close"),playlistModalTitle:document.getElementById("playlistModalTitle"),playlistFileBtn:document.getElementById("playlist-file-btn"),playlistFileBtnText:document.getElementById("playlistFileBtnText"),playlistFileInput:document.getElementById("playlist-file-input"),playlistImportBtn:document.getElementById("playlist-import-btn"),playlistImportBtnText:document.getElementById("playlistImportBtnText"),playlistClearBtn:document.getElementById("playlist-clear-btn"),playlistClearBtnText:document.getElementById("playlistClearBtnText"),playlistTextarea:document.getElementById("playlist-textarea"),playlistList:document.getElementById("playlist-list"),playlistEmpty:document.getElementById("playlist-empty"),shortcutTip:document.getElementById("shortcut-tip"),touchTip:document.getElementById("touch-tip"),langLabel:document.getElementById("langLabel"),themeLabel:document.getElementById("themeLabel"),speedLabel:document.getElementById("speedLabel"),qualityLabel:document.getElementById("qualityLabel"),shortcutTitle:document.getElementById("shortcutTitle"),shortcutPlay:document.getElementById("shortcutPlay"),shortcutForward:document.getElementById("shortcutForward"),shortcutBackward:document.getElementById("shortcutBackward"),shortcutVolUp:document.getElementById("shortcutVolUp"),shortcutVolDown:document.getElementById("shortcutVolDown"),shortcutFullscreen:document.getElementById("shortcutFullscreen"),shortcutPip:document.getElementById("shortcutPip"),shortcutScreenshot:document.getElementById("shortcutScreenshot"),pageTitle:document.getElementById("pageTitle"),langSelect:document.getElementById("lang-select"),themeSelect:document.getElementById("theme-select"),logHeader:document.getElementById("log-header"),logBody:document.getElementById("log-body"),logTitle:document.getElementById("logTitle"),logClear:document.getElementById("log-clear"),sidebar:document.getElementById("sidebar"),sidebarToggle:document.getElementById("sidebar-toggle"),historySidebarToggle:document.getElementById("history-sidebar-toggle")};let o=null,s=!1,l="",r=null,i=null,a=localStorage.getItem("playerLang")||"zh-CN",c=null;function d(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function u(){return window.playHistoryStorage||null}function m(e){if(!e||"string"!=typeof e)return!1;try{const t=new URL(e);return["http:","https:"].includes(t.protocol)}catch(t){return/^https?:\/\/.+\.(m3u8|mp4|webm|ogg|avi|mov|wmv)/i.test(e)||/^https?:\/\/.+\/playlist\.m3u8/i.test(e)}}const p="playerPlaylist_v1";function y(){try{const e=localStorage.getItem(p);if(!e)return{version:1,epgUrls:[],items:[]};const t=JSON.parse(e);if(!t||"object"!=typeof t)return{version:1,epgUrls:[],items:[]};const n=Array.isArray(t.epgUrls)?t.epgUrls.filter(e=>"string"==typeof e):[];return{version:1,epgUrls:n,items:Array.isArray(t.items)?t.items.filter(e=>e&&"object"==typeof e):[]}}catch{return{version:1,epgUrls:[],items:[]}}}function h(e){const t={version:1,epgUrls:Array.isArray(e?.epgUrls)?e.epgUrls:[],items:Array.isArray(e?.items)?e.items:[]};localStorage.setItem(p,JSON.stringify(t))}function g(e){return"string"!=typeof e?"":function(e){if("string"!=typeof e)return"";const t=e.trim();return t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1).trim():t}(e.replace(/`/g,"").trim())}function v(e){const t=g(e);if(!t)return"";const n=t.indexOf("$");return(n>=0?t.slice(0,n):t).trim()}function f(){if(!n.playlistList||!n.playlistEmpty)return;const e=y();if(n.playlistList.innerHTML="",!e.items.length)return n.playlistList.appendChild(n.playlistEmpty),void(n.playlistEmpty.style.display="block");n.playlistEmpty.style.display="none";const t=document.createDocumentFragment();e.items.forEach(e=>{const n=document.createElement("div");n.className="playlist-item";const o=d(e.title||e.url),s=d(e.rawUrl||e.url),l=d(e.url),r=e.group?`<div class="playlist-item-meta">${d(e.group)}</div>`:"";n.innerHTML=`\n            <div class="playlist-item-content">\n                <div class="playlist-item-title">${o}</div>\n                ${r}\n                <div class="playlist-item-url" title="${s}">${s.length>80?`${s.slice(0,80)}...`:s}</div>\n            </div>\n            <div class="playlist-item-actions">\n                <button class="playlist-item-play" title="播放" data-url="${l}">\n                    <i class="fas fa-play"></i>\n                </button>\n            </div>\n        `,t.appendChild(n)}),n.playlistList.appendChild(t),function(){if(!n.playlistList)return;n.playlistList.removeEventListener("click",E),n.playlistList.addEventListener("click",E)}()}function E(e){const t=e.target.closest(".playlist-item-play");if(!t)return;const o=t.dataset.url;o&&(n.urlInput.value=o,j(o),w())}function B(){n.playlistModal&&(n.playlistModal.classList.add("show"),f())}function w(){n.playlistModal&&n.playlistModal.classList.remove("show")}function L(e){const t=function(e){const t=("string"==typeof e?e.replace(/\r\n?/g,"\n"):"").split("\n"),n=[],o=new Set;let s=null;for(const i of t){const e=g(i);if(!e)continue;if(e.startsWith("#EXTM3U")){(e.match(/https?:\/\/[^\s",]+/g)||[]).forEach(e=>o.add(e));continue}if(e.startsWith("#EXTINF")){const t={};e.replace(/([a-zA-Z0-9_-]+)\s*=\s*"([^"]*)"/g,(e,n,o)=>(t[n]=o,""));const n=e.lastIndexOf(","),o=n>=0?e.slice(n+1).trim():"";s={attrs:t,displayName:o};continue}if(e.startsWith("#"))continue;const t=v(e);if(!t)continue;const l={title:s?.displayName||s?.attrs?.["tvg-name"]||t,url:t,rawUrl:g(e),group:s?.attrs?.["group-title"]||"",logo:s?.attrs?.["tvg-logo"]||"",tvgId:s?.attrs?.["tvg-id"]||"",tvgName:s?.attrs?.["tvg-name"]||""};n.push(l),s=null}const l=[],r=new Set;for(const i of n)i?.url&&"string"==typeof i.url&&m(i.url)&&(r.has(i.url)||(r.add(i.url),l.push(i)));return{epgUrls:Array.from(o),items:l}}(e),n=y().items.length,o=function(e){const t=y(),n=new Set(t.items.map(e=>e?.url).filter(Boolean));for(const s of e.items||[])s?.url&&!n.has(s.url)&&(t.items.push(s),n.add(s.url));const o=new Set(t.epgUrls);for(const s of e.epgUrls||[])"string"==typeof s&&s&&o.add(s);return t.epgUrls=Array.from(o),h(t),t}(t),s=o.items.length-n;f();T("zh-CN"===a?`播放列表导入完成：新增 ${s} 条，共 ${o.items.length} 条`:`Playlist imported: +${s}, total ${o.items.length}`,"success")}function I(e){const t=function(e){if(!e)return!1;const t=y(),o=t.items.findIndex(t=>t?.url===e);return!(o<0||(t.items.splice(o,1),h(t),n.playlistModal?.classList.contains("show")&&f(),0))}(e);t&&T("zh-CN"===a?"播放失败，已从导入列表移除该地址":"Playback failed, removed from imported list","error")}function S(e){a=e,localStorage.setItem("playerLang",e);const t=i18n[e];n.pageTitle&&(n.pageTitle.textContent=t.pageTitle),n.langLabel&&(n.langLabel.textContent=t.langLabel),n.themeLabel&&(n.themeLabel.textContent=t.themeLabel),n.speedLabel&&(n.speedLabel.textContent=t.speedLabel),n.qualityLabel&&(n.qualityLabel.textContent=t.qualityLabel),n.alignLabel&&(n.alignLabel.textContent=t.alignLabel),n.loadPlayText&&(n.loadPlayText.textContent=t.loadPlayBtn);const o=(e,t,n)=>{e&&(e.innerHTML=`<i class="${t}"></i> <span>${d(n)}</span>`)};o(n.pauseBtn,"fas fa-pause",t.pauseBtn),o(n.fullscreenBtn,"fas fa-expand",t.fullscreenBtn),o(n.pipBtn,"fas fa-expand-arrows-alt",t.pipBtn),o(n.screenshotBtn,"fas fa-camera",t.screenshotBtn),o(n.shortcutBtn,"fas fa-keyboard",t.shortcutBtn),o(n.clearCacheBtn,"fas fa-trash",t.clearCacheBtn),o(n.historyBtn,"fas fa-history",t.historyBtn),o(n.playlistBtn,"fas fa-list",t.playlistBtn),n.urlInput&&(n.urlInput.placeholder=t.urlInputPlaceholder),n.shortcutTitle&&(n.shortcutTitle.textContent=t.shortcutTitle),n.historyTitle&&(n.historyTitle.textContent=t.historyTitle),n.historyClear&&(n.historyClear.textContent=t.clearHistoryBtn),n.shortcutPlay&&(n.shortcutPlay.textContent=t.shortcutPlay),n.shortcutForward&&(n.shortcutForward.textContent=t.shortcutForward),n.shortcutBackward&&(n.shortcutBackward.textContent=t.shortcutBackward),n.shortcutVolUp&&(n.shortcutVolUp.textContent=t.shortcutVolUp),n.shortcutVolDown&&(n.shortcutVolDown.textContent=t.shortcutVolDown),n.shortcutFullscreen&&(n.shortcutFullscreen.textContent=t.shortcutFullscreen),n.shortcutPip&&(n.shortcutPip.textContent=t.shortcutPip),n.shortcutScreenshot&&(n.shortcutScreenshot.textContent=t.shortcutScreenshot),n.touchTip&&(n.touchTip.textContent=t.touchTip),n.logTitle&&(n.logTitle.textContent=t.logTitle),n.screenshotDownload&&(n.screenshotDownload.textContent=t.screenshotDownload),n.playlistModalTitle&&(n.playlistModalTitle.textContent=t.playlistModalTitle),n.playlistFileBtnText&&(n.playlistFileBtnText.textContent=t.playlistFileBtn),n.playlistImportBtnText&&(n.playlistImportBtnText.textContent=t.playlistImportBtn),n.playlistClearBtnText&&(n.playlistClearBtnText.textContent=t.playlistClearBtn),n.playlistTextarea&&(n.playlistTextarea.placeholder=t.playlistTextareaPlaceholder),n.playlistEmpty&&(n.playlistEmpty.textContent=t.playlistEmpty),C("切换语言至 "+("zh-CN"===e?"中文":"English"),"info")}function b(e){document.body.className=e,localStorage.setItem("playerTheme",e),C("切换主题至 "+("light"===e?"亮色":"暗色"),"info")}function C(e,t="info"){const n=new Date;n.getHours().toString().padStart(2,"0"),n.getMinutes().toString().padStart(2,"0"),n.getSeconds().toString().padStart(2,"0")}function T(e,t,o={}){if("string"!=typeof e)return;if(!n.statusTip)return;const{duration:s=3e3,keepVisible:l=!1,logLevel:r=("error"===t?"error":"success")}=o;n.statusTip.textContent=e,n.statusTip.className=`status-tip show ${t}`,C(0,r),l||(window.statusTipTimer&&clearTimeout(window.statusTipTimer),window.statusTipTimer=setTimeout(()=>{n.statusTip.classList.remove("show")},s))}function x(e=i18n[a].loadingText){s=!0,n.loadingMask&&n.loadingText&&(n.loadingMask.classList.add("show"),n.loadingText.textContent=e,T(e,"loading",{keepVisible:!0,logLevel:"info"}),C(0,"info"))}function k(){s=!1,n.loadingMask&&n.loadingMask.classList.remove("show"),n.statusTip&&n.statusTip.classList.remove("show"),C(0,"info")}function M(){const e=i18n[a].confirmClearCache||"确定要清理所有播放器设置缓存吗？这将删除您的现有设定，只保留播放记录。";confirm(e)?(localStorage.removeItem("playerPreferredSpeed"),localStorage.removeItem("playerTheme"),localStorage.removeItem("playerLang"),localStorage.removeItem("playerVolume"),localStorage.removeItem("playerMuted"),localStorage.removeItem("playerQuality"),localStorage.removeItem("historySortMode"),localStorage.removeItem("playerAlignment"),localStorage.removeItem("helpModalShown"),localStorage.removeItem("lastPlayedVideoUrl"),n.urlInput&&(n.urlInput.value=""),n.speedSelect.value="1",n.video.playbackRate=1,n.langSelect.value="zh-CN",n.volumeSlider.value=.5,n.video.volume=.5,n.video.muted=!1,_(),S("zh-CN"),document.body.classList.remove("player-align-left","player-align-center","player-align-right"),document.body.classList.add("player-align-center"),n.alignLeftBtn&&n.alignLeftBtn.classList.remove("active"),n.alignCenterBtn&&n.alignCenterBtn.classList.add("active"),n.alignRightBtn&&n.alignRightBtn.classList.remove("active"),n.sortRecentBtn&&n.sortHotBtn&&(n.sortRecentBtn.classList.add("active"),n.sortHotBtn.classList.remove("active")),T(i18n[a].statusSuccessClearCache,"success"),C(0,"success")):C(0,"info")}function N(e){localStorage.setItem("playerPreferredSpeed",e),C(0,"info")}function P(){try{if(!n.video.src||0===n.video.videoWidth||0===n.video.videoHeight)return void T(i18n[a].statusErrorScreenshot.replace("{msg}","视频未加载或无效"),"error");const e=document.createElement("canvas");e.width=n.video.videoWidth,e.height=n.video.videoHeight;e.getContext("2d").drawImage(n.video,0,0,e.width,e.height);const t=e.toDataURL("image/png");n.screenshotImg.src=t,n.screenshotModal.classList.add("show"),n.screenshotDownload.onclick=()=>{const e=document.createElement("a");e.href=t;const n=(new Date).toISOString().replace(/[:.]/g,"-"),o="zh-CN"===a?`视频截图_${n}.png`:`Video_Screenshot_${n}.png`;e.download=o,e.click(),T(i18n[a].statusSuccessScreenshotDownload,"success")},T(i18n[a].statusSuccessScreenshot,"success")}catch(e){e.message.includes("Not allowed to load local resource")||e.message.includes("blob:")?T(i18n[a].statusErrorScreenshot.replace("{msg}","浏览器安全限制，无法生成截图"),"error"):T(i18n[a].statusErrorScreenshot.replace("{msg}",e.message),"error")}}function R(){document.pictureInPictureElement?document.exitPictureInPicture().then(()=>{const e=n.pipBtn.querySelector("span");e&&(e.textContent="zh-CN"===a?"画中画":"PiP"),T(i18n[a].statusSuccessExitPip,"success")}).catch(e=>{T(i18n[a].statusErrorPip.replace("{action}","zh-CN"===a?"退出":"Exit ").replace("{msg}",e.message),"error")}):n.video.requestPictureInPicture().then(()=>{const e=n.pipBtn.querySelector("span");e&&(e.textContent="zh-CN"===a?"退出画中画":"Exit PiP"),T(i18n[a].statusSuccessPip,"success")}).catch(e=>{T(i18n[a].statusErrorPip.replace("{action}","zh-CN"===a?"进入":"Enter ").replace("{msg}",e.message),"error")})}function U(){if(document.fullscreenElement){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();const e=n.fullscreenBtn.querySelector("span");e&&(e.textContent="zh-CN"===a?"全屏":"Fullscreen"),T(i18n[a].statusSuccessExitFullscreen,"success")}else{n.video.requestFullscreen?n.video.requestFullscreen():n.video.webkitRequestFullscreen?n.video.webkitRequestFullscreen():n.video.msRequestFullscreen&&n.video.msRequestFullscreen();const e=n.fullscreenBtn.querySelector("span");e&&(e.textContent="zh-CN"===a?"退出全屏":"Exit Fullscreen"),T(i18n[a].statusSuccessFullscreen,"success")}}function $(){navigator.onLine?(n.statusTip.classList.remove("show"),l&&n.video.paused&&(r=setInterval(()=>{s||(x(i18n[a].statusReconnect),j(l,!0))},3e3)),C(0,"info")):(T(i18n[a].statusOffline,"offline"),n.video.pause(),r&&clearInterval(r),C(0,"error"))}async function F(e,t=0){try{if("string"!=typeof e)throw new TypeError("URL必须是字符串类型");if(!e)return;if(!m(e))return void C(0,"warn");if("number"!=typeof t||isNaN(t))throw new TypeError("播放时间必须是数字类型");c&&clearTimeout(c),c=setTimeout(async()=>{try{const o=u();if(!o)return;const s=await o.getRecord(e),l={url:e,title:s?s.title:e.split("/").pop().split("?")[0]||"未命名视频",time:Math.round(t),duration:Math.round(n.video.duration||s?.duration||0),date:(new Date).toISOString(),playCount:(s?.playCount||0)+1};await o.saveRecord(l),C(0,"info"),await z()}catch(o){C(o.message,"error")}},2e3)}catch(o){C(o.message,"error")}}async function D(e="date",t="desc"){try{const n=u();return n?await n.getAllRecords({sortBy:e,sortOrder:t}):[]}catch(n){return[]}}async function z(e=null){const t=e||localStorage.getItem("historySortMode")||"recent";let o,s;localStorage.setItem("historySortMode",t),"hot"===t?(o="playCount",s="desc"):(o="date",s="desc"),n.sortRecentBtn&&n.sortHotBtn&&(n.sortRecentBtn.classList.toggle("active","recent"===t),n.sortHotBtn.classList.toggle("active","hot"===t));const r=await D(o,s),i=n.historyBody,a=n.historyEmpty;if(i.innerHTML="",0===r.length)i.appendChild(a),a.style.display="block";else{a.style.display="none";const e=document.createDocumentFragment();r.forEach(t=>{const n=document.createElement("div"),o=l===t.url;n.className="history-item "+(o?"current-playing":"");const s=new Date(t.date).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),r=t.duration>0?Math.round(t.time/t.duration*100):0;n.innerHTML=`\n                <div class="history-item-content">\n                    <div class="history-item-title-container">\n                        <span class="history-item-title" data-url="${d(t.url)}">${d(t.title)}</span>\n                        <button class="history-item-edit" title="编辑名称" data-url="${d(t.url)}">\n                            <i class="fas fa-edit"></i>\n                        </button>\n                    </div>\n                    <div class="history-item-meta">\n                        <span class="history-item-date">${s}</span>\n                        ${t.duration>0?`<span class="history-item-time">播放进度：${V(t.time)} / ${V(t.duration)} (${r}%)</span>`:""}\n                        <span class="history-item-playcount"><i class="fas fa-fire" style="color: #ff9800; margin-right: 4px;"></i>${t.playCount||1}次播放</span>\n                    </div>\n                    <div class="history-item-url" title="${d(t.url)}">${d(t.url.length>50?`${t.url.substring(0,50)}...`:t.url)}</div>\n                </div>\n                <div class="history-item-actions">\n                    <button class="history-item-play" title="播放" data-url="${d(t.url)}">\n                        <i class="fas fa-play"></i>\n                    </button>\n                    <button class="history-item-delete" title="删除" data-url="${d(t.url)}">\n                        <i class="fas fa-trash"></i>\n                    </button>\n                </div>\n            `,e.appendChild(n)}),i.appendChild(e)}!function(){const e=n.historyBody;e.removeEventListener("click",q),e.addEventListener("click",q)}()}function q(e){const t=e.target;if(t.closest(".history-item-play")){const e=t.closest(".history-item-play").dataset.url;n.urlInput.value=e,j(e)}else if(t.closest(".history-item-delete")){!async function(e){try{const t=u();if(!t)return;await t.deleteRecord(e),await z(),C(0,"info")}catch(t){T("删除播放历史失败","error")}}(t.closest(".history-item-delete").dataset.url)}else if(t.closest(".history-item-edit")){!async function(e){try{const t=u();if(!t)return;const n=await t.getRecord(e);if(!n)return;const o=prompt("请输入新的名称：",n.title);null!==o&&""!==o.trim()&&(n.title=o.trim(),await t.saveRecord(n),await z(),C(0,"info"))}catch(t){T("编辑播放历史失败","error")}}(t.closest(".history-item-edit").dataset.url)}}async function O(){try{const e=await D(),t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download=`video-play-history-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o),C(0,"info"),T("播放历史导出成功","success")}catch(e){T("导出播放历史失败","error")}}function V(e){if(!e||isNaN(e))return"00:00";const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function A(e,t){!e||t<5||(F(e,t),C(Math.round(t),"info"))}async function H(e){try{return 0}catch(t){return 0}}async function j(s,i=!1){try{if("string"!=typeof s)throw new TypeError("URL必须是字符串类型");if(!s||!s.trim())return void T(i18n[a].statusErrorUrl,"error");const u=s.trim();if(!function(e){return!!m(e)&&([".m3u8",".mp4",".webm",".ogg",".avi",".mov",".wmv"].some(t=>e.toLowerCase().includes(t))||/\/playlist\.m3u8/i.test(e))}(u))return T("错误：请输入有效的视频URL（支持m3u8、mp4、webm、ogg、avi、mov、wmv格式）","error"),void C(0,"error");if(l=u,localStorage.setItem("lastPlayedVideoUrl",u),C(0,"info"),k(),o&&(o.destroy(),o=null,C(0,"info")),n.video.pause(),n.video.src&&(n.video.src="",n.video.mediaSource))try{n.video.mediaSource.endOfStream()}catch(c){}if(n.fullscreenBtn.disabled=!0,n.pipBtn.disabled=!0,n.screenshotBtn.disabled=!0,n.qualitySelect.disabled=!0,n.progressBar.style.width="0%",n.progressLoaded.style.width="0%",r&&(clearInterval(r),r=null),x(i18n[a].loadingText),s.toLowerCase().includes(".m3u8"))try{t||await async function(){if(!t)try{const n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/hls.js@latest",n.async=!0,await new Promise((e,t)=>{n.onload=e,n.onerror=t,document.head.appendChild(n)}),e=window.Hls,t=!0}catch(n){throw n}}(),e.isSupported()?(o=new e({maxBufferLength:30,startLevel:-1,enableWorker:!0,lowLatencyMode:!0}),o.attachMedia(n.video),o.on(e.Events.MANIFEST_PARSED,async()=>{if(k(),function(e){if(!e||!e.levels||0===e.levels.length)return n.qualitySelect.disabled=!0,void(n.qualitySelect.innerHTML='<option value="">自动</option>');n.qualitySelect.innerHTML='<option value="">自动</option>',n.qualitySelect.disabled=!1,e.levels.forEach((e,t)=>{const o=Math.round(e.bitrate/1e3),s=`${e.width||"Unknown"}x${e.height||"Unknown"} (${o}kbps)`,l=document.createElement("option");l.value=t,l.textContent=s,n.qualitySelect.appendChild(l)});const t=localStorage.getItem("playerQuality");t&&(n.qualitySelect.value=t,e.currentLevel=""===t?-1:Number(t)),n.qualitySelect.addEventListener("change",()=>{const t=n.qualitySelect.value;e.currentLevel=""===t?-1:Number(t),localStorage.setItem("playerQuality",t);const o=""===t?"zh-CN"===a?"自动":"Auto":n.qualitySelect.options[n.qualitySelect.selectedIndex].text;T(i18n[a].statusSuccessQuality.replace("{quality}",o),"success")})}(o),i){const e=await H();e>0&&(n.video.currentTime=e)}T(i18n[a].statusSuccessLoad,"success"),n.fullscreenBtn.disabled=!1,n.pipBtn.disabled=!("pictureInPictureEnabled"in document),n.screenshotBtn.disabled=!1,await F(s),n.video.play().catch(e=>{})}),o.on(e.Events.LOADING_PROGRESS,(e,t)=>{const o=t.loaded/t.total*100;n.progressLoaded.style.width=`${o}%`}),o.on(e.Events.ERROR,(t,s)=>{k();let r=i18n[a].statusErrorLoad;if(s.fatal)switch(s.type){case e.ErrorTypes.NETWORK_ERROR:r=i18n[a].statusErrorNetwork,o.startLoad();break;case e.ErrorTypes.MEDIA_ERROR:r=i18n[a].statusErrorDecode,o.recoverMediaError();break;default:r=i18n[a].statusErrorUnknown.replace("{msg}",s.details);I(l),o.destroy(),o=null,n.video.src="",n.fullscreenBtn.disabled=!0,n.pipBtn.disabled=!0,n.screenshotBtn.disabled=!0}T(r,"error")}),o.loadSource(s)):n.video.canPlayType("application/vnd.apple.mpegurl")?(n.video.src=s,n.video.addEventListener("loadedmetadata",async()=>{if(k(),i){const e=await H();e>0&&(n.video.currentTime=e)}T(i18n[a].statusSuccessLoadNative,"success"),n.fullscreenBtn.disabled=!1,n.pipBtn.disabled=!("pictureInPictureEnabled"in document),n.screenshotBtn.disabled=!1,await F(s),n.video.play().catch(e=>{})},{once:!0}),n.video.addEventListener("error",e=>{k();const t="zh-CN"===a?"视频加载失败：无法播放此格式":"Video load failed: Format not supported";T(i18n[a].statusErrorVideo.replace("{msg}",t),"error"),I(l)},{once:!0})):(k(),T(i18n[a].statusErrorUnknown.replace("{msg}","当前浏览器不支持播放 m3u8 格式"),"error"),n.video.src="")}catch(d){k(),T(i18n[a].statusErrorUnknown.replace("{msg}","hls.js 加载失败"),"error"),C(d.message,"error")}else n.video.src=s,n.video.addEventListener("loadedmetadata",async()=>{if(k(),i){const e=await H();e>0&&(n.video.currentTime=e)}T(i18n[a].statusSuccessLoad,"success"),n.fullscreenBtn.disabled=!1,n.pipBtn.disabled=!("pictureInPictureEnabled"in document),n.screenshotBtn.disabled=!1,await F(s),n.video.play().catch(e=>{})},{once:!0}),n.video.addEventListener("error",e=>{k();let t="";const o=n.video.error;if(o){const e={1:"zh-CN"===a?"视频加载被中止":"Video load aborted",2:"zh-CN"===a?"网络请求失败":"Network request failed",3:"zh-CN"===a?"视频解码失败":"Video decoding failed",4:"zh-CN"===a?"视频格式不支持":"Video format not supported",5:"zh-CN"===a?"视频加载超时":"Video load timeout"};t=o.message&&o.message.includes("has no supported sources")?"zh-CN"===a?"视频没有有效的源":"The video has no supported sources":e[o.code]||o.message||"Unknown error"}else t="zh-CN"===a?"视频加载失败":"Video load failed";T(i18n[a].statusErrorVideo.replace("{msg}",t),"error"),I(l)},{once:!0})}catch(d){k();T(`视频加载异常：${d.message||"未知错误"}`,"error"),C(d.message,"error")}}async function W(e){const t=document.getElementById("history-body");if(document.getElementById("history-empty"),"default"===e)return await z(),void C(0,"info");t.innerHTML="";const n=await async function(e){return new Promise((t,n)=>{const o=indexedDB.open("PlaylistDB",1);o.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("playlists")||t.createObjectStore("playlists",{keyPath:"id"})},o.onsuccess=o=>{const s=o.target.result,l=s.transaction("playlists","readonly").objectStore("playlists").get(e);l.onsuccess=e=>{const n=e.target.result,o=n?n.history:[];t(o),s.close()},l.onerror=e=>{n(e.target.error),s.close()}},o.onerror=e=>{n(e.target.error)}})}(e);if(0===n.length){const e=document.createElement("div");e.className="history-empty",e.textContent="暂无播放历史",t.appendChild(e)}else{n.forEach(e=>{const n=document.createElement("div");n.className="history-item",n.innerHTML=`\n                <div class="history-item-title">${e.title||e.url}</div>\n                <div class="history-item-time">${new Date(e.lastPlayed).toLocaleString()}</div>\n                <button class="history-item-play" data-url="${e.url}">播放</button>\n            `,t.appendChild(n)});document.querySelectorAll(".history-item-play").forEach(e=>{e.addEventListener("click",()=>{j(e.getAttribute("data-url"))})})}C(0,"info")}function _(){const e=n.video.volume,t=n.volumeIcon;n.video.muted||0===e?t.className="fas fa-volume-mute":t.className=e<.5?"fas fa-volume-down":"fas fa-volume-up"}function X(){n.centerPlayBtn&&(n.video.paused||n.video.ended?n.centerPlayBtn.classList.remove("hide"):n.centerPlayBtn.classList.add("hide"))}function J(){function e(){n.urlInput.value.trim()?n.urlClearBtn.classList.add("visible"):n.urlClearBtn.classList.remove("visible")}n.video.addEventListener("play",()=>{X(),T(i18n[a].statusSuccessPlay,"success")}),n.video.addEventListener("pause",()=>{A(l,n.video.currentTime),X(),T(i18n[a].statusSuccessPause,"success")}),n.video.addEventListener("ended",()=>{A(l,0),X(),T(i18n[a].statusSuccessEnd,"success")}),n.centerPlayBtn.addEventListener("click",()=>{if(s)return;const e=n.urlInput.value.trim();e?l!==e?j(e):n.video.paused||n.video.ended?n.video.play().catch(e=>{T(i18n[a].statusErrorUnknown.replace("{msg}",e.message),"error")}):n.video.pause():T(i18n[a].statusErrorUrl,"error")}),n.fullscreenBtn.addEventListener("click",U),document.addEventListener("fullscreenchange",()=>{const e=n.fullscreenBtn.querySelector("span");e&&(e.textContent=document.fullscreenElement?"zh-CN"===a?"退出全屏":"Exit Fullscreen":"zh-CN"===a?"全屏":"Fullscreen")}),document.addEventListener("webkitfullscreenchange",()=>{const e=n.fullscreenBtn.querySelector("span");e&&(e.textContent=document.webkitFullscreenElement?"zh-CN"===a?"退出全屏":"Exit Fullscreen":"zh-CN"===a?"全屏":"Fullscreen")}),n.pipBtn.addEventListener("click",R),n.video.addEventListener("enterpictureinpicture",()=>{const e=n.pipBtn.querySelector("span");e&&(e.textContent="zh-CN"===a?"退出画中画":"Exit PiP")}),n.video.addEventListener("leavepictureinpicture",()=>{const e=n.pipBtn.querySelector("span");e&&(e.textContent="zh-CN"===a?"画中画":"PiP")}),n.screenshotBtn.addEventListener("click",P),n.screenshotClose.addEventListener("click",()=>{n.screenshotModal.classList.remove("show"),n.screenshotImg.src=""}),n.screenshotModal.addEventListener("click",e=>{e.target===n.screenshotModal&&(n.screenshotModal.classList.remove("show"),n.screenshotImg.src="")}),n.volumeSlider.addEventListener("input",()=>{n.video.volume=n.volumeSlider.value,n.video.muted=0==n.volumeSlider.value,localStorage.setItem("playerVolume",n.volumeSlider.value),localStorage.setItem("playerMuted",n.video.muted),_()}),n.volumeIcon.addEventListener("click",()=>{n.video.muted=!n.video.muted,n.video.muted?n.volumeSlider.value=0:(n.volumeSlider.value=localStorage.getItem("playerVolume")||.5,n.video.volume=n.volumeSlider.value),localStorage.setItem("playerVolume",n.volumeSlider.value),localStorage.setItem("playerMuted",n.video.muted),_()}),n.speedSelect.addEventListener("change",()=>{const e=n.speedSelect.value;n.video.playbackRate=e,N(e),T(i18n[a].statusSuccessSpeed.replace("{speed}",e),"success")}),n.video.addEventListener("timeupdate",()=>{if(!n.video.duration)return;const e=n.video.currentTime/n.video.duration*100;n.progressBar.style.width=`${e}%`,X()}),n.video.addEventListener("progress",()=>{if(0===n.video.buffered.length)return;const e=n.video.buffered.end(n.video.buffered.length-1)/n.video.duration*100;n.progressLoaded.style.width=`${e}%`}),n.progressWrap.addEventListener("click",e=>{if(!n.video.duration)return;const t=n.progressWrap.getBoundingClientRect(),o=(e.clientX-t.left)/t.width;n.video.currentTime=o*n.video.duration,n.progressBar.style.width=100*o+"%"}),n.video.addEventListener("ended",()=>{A(l,0),T(i18n[a].statusSuccessEnd,"success")}),n.urlInput.addEventListener("keydown",e=>{if("Enter"===e.key){const e=n.urlInput.value.trim();e?j(e):T(i18n[a].statusErrorUrl,"error")}}),e(),n.urlInput.addEventListener("input",e),n.urlInput.addEventListener("focus",e),n.urlInput.addEventListener("blur",e),n.urlClearBtn.addEventListener("click",()=>{n.urlInput.value="",e(),n.urlInput.focus()}),n.langSelect.addEventListener("change",e=>{S(e.target.value)}),n.themeSelect.addEventListener("change",e=>{b(e.target.value)}),n.clearCacheBtn.addEventListener("click",M),window.addEventListener("online",$),window.addEventListener("offline",$),n.helpBtn&&n.helpModal&&n.helpClose&&(n.helpBtn.addEventListener("click",()=>{n.helpModal.classList.add("show"),C(0,"info")}),n.helpClose.addEventListener("click",Q),n.helpModal.addEventListener("click",e=>{e.target===n.helpModal&&Q()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&n.helpModal.classList.contains("show")&&Q()})),n.playlistBtn&&n.playlistModal&&n.playlistClose&&(n.playlistBtn.addEventListener("click",()=>{B(),C(0,"info")}),n.playlistClose.addEventListener("click",w),n.playlistModal.addEventListener("click",e=>{e.target===n.playlistModal&&w()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&n.playlistModal.classList.contains("show")&&w()}),n.playlistFileBtn&&n.playlistFileInput&&(n.playlistFileBtn.addEventListener("click",()=>{n.playlistFileInput.click()}),n.playlistFileInput.addEventListener("change",async e=>{const t=e.target.files[0];if(t)try{const e=await function(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=e=>t(e.target.result),o.onerror=e=>n(e.target.error||new Error("read file failed")),o.readAsText(e)})}(t);n.playlistTextarea&&(n.playlistTextarea.value=e),L(e)}catch(o){const e=o?.message||String(o);T("zh-CN"===a?`读取文件失败：${e}`:`Failed to read file: ${e}`,"error")}finally{e.target.value=""}})),n.playlistImportBtn&&n.playlistTextarea&&n.playlistImportBtn.addEventListener("click",()=>{const e=n.playlistTextarea.value||"";e.trim()?L(e):T("zh-CN"===a?"请先粘贴 M3U 内容":"Please paste M3U content first","error")}),n.playlistClearBtn&&n.playlistClearBtn.addEventListener("click",()=>{h({epgUrls:[],items:[]}),f(),T("zh-CN"===a?"播放列表已清空":"Playlist cleared","success")})),n.historySidebarToggle&&n.sidebar&&n.historySidebarToggle.addEventListener("click",async()=>{n.sidebar.classList.toggle("hidden"),!n.sidebar.classList.contains("hidden")&&n.historyBody&&n.historyBody.classList.add("show"),await z(),C(0,"info")}),n.historyExport&&n.historyExport.addEventListener("click",O);const t=document.getElementById("playlist-import"),o=document.getElementById("playlist-export"),r=document.getElementById("playlist-select");t&&t.addEventListener("click",()=>{B()}),o&&o.addEventListener("click",async()=>{await async function(){const e=u();if(!e)return void T("zh-CN"===a?"播放历史不可用，无法导出":"Play history unavailable","error");const t=await e.getAllRecords({sortBy:"date",sortOrder:"desc",limit:1e4});if(!t.length)return void T("zh-CN"===a?"播放历史为空，无法导出":"Play history is empty","error");const n=["#EXTM3U"];for(const i of t){const e=String(i?.title?i.title:i?.url||""),t=i?.url?String(i.url):"";t&&(n.push(`#EXTINF:-1,${e}`),n.push(t))}const o=n.join("\n")+"\n",s=new Blob([o],{type:"audio/x-mpegurl;charset=utf-8"}),l=URL.createObjectURL(s),r=document.createElement("a");r.href=l,r.download=`play-history-${(new Date).toISOString().slice(0,10)}.m3u`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(l),T("zh-CN"===a?"已导出播放历史为 M3U":"Exported play history as M3U","success")}()}),r&&r.addEventListener("change",async()=>{const e=r.value;await W(e),C(0,"info")});const i=document.getElementById("resize-handle"),c=document.getElementById("sidebar"),d=document.querySelector(".player-area");if(i&&c&&d){let e=!1,t=0,n=0;i.addEventListener("mousedown",o=>{e=!0,t=o.clientX,n=parseInt(document.defaultView.getComputedStyle(c).width,10),document.body.style.cursor="ew-resize",document.body.style.userSelect="none",document.body.classList.add("resizing"),o.preventDefault()}),document.addEventListener("mousemove",o=>{if(!e)return;const s=o.clientX-t,l=n+s;l<200||l>window.innerWidth/2||(c.style.width=`${l}px`,d.style.width=window.innerWidth-l-5+"px",i.style.left=`${l}px`,d.style.marginLeft=`${l+5}px`)}),document.addEventListener("mouseup",()=>{e=!1,document.body.style.cursor="",document.body.style.userSelect="",document.body.classList.remove("resizing")})}function m(e){document.body.classList.remove("player-align-left","player-align-center","player-align-right"),document.body.classList.add(`player-align-${e}`),n.alignLeftBtn&&n.alignLeftBtn.classList.remove("active"),n.alignCenterBtn&&n.alignCenterBtn.classList.remove("active"),n.alignRightBtn&&n.alignRightBtn.classList.remove("active"),"left"===e&&n.alignLeftBtn?n.alignLeftBtn.classList.add("active"):"center"===e&&n.alignCenterBtn?n.alignCenterBtn.classList.add("active"):"right"===e&&n.alignRightBtn&&n.alignRightBtn.classList.add("active"),localStorage.setItem("playerAlignment",e),C(0,"info")}(JSON.parse(localStorage.getItem("playlists"))||[]).forEach(e=>{const t=document.createElement("option");t.value=e.id,t.textContent=e.name,r.appendChild(t)}),z(),X(),n.video.addEventListener("click",()=>{s||(n.video.paused||n.video.ended?n.video.play().catch(e=>{T(i18n[a].statusErrorUnknown.replace("{msg}",e.message),"error")}):n.video.pause())}),n.alignLeftBtn&&n.alignLeftBtn.addEventListener("click",()=>{m("left")}),n.alignCenterBtn&&n.alignCenterBtn.addEventListener("click",()=>{m("center")}),n.alignRightBtn&&n.alignRightBtn.addEventListener("click",()=>{m("right")});m(localStorage.getItem("playerAlignment")||"center"),window.addEventListener("beforeunload",()=>{l&&(A(l,n.video.currentTime),F(l,n.video.currentTime)),N(n.video.playbackRate),C(0,"info")}),n.video&&n.video.addEventListener("ended",()=>{l&&F(l,n.video.duration)})}function Q(){n.helpModal&&(n.helpModal.classList.remove("show"),localStorage.setItem("helpModalShown","true"),C(0,"info"))}window.onload=async()=>{C(0,"info");const e=localStorage.getItem("playerTheme")||"light";n.themeSelect.value=e,b(e),n.langSelect&&(n.langSelect.value=a),S(a);const t=function(){const e=localStorage.getItem("playerPreferredSpeed")||"1";return C(0,"info"),e}();n.speedSelect.value=t,n.video.playbackRate=t;const o=localStorage.getItem("playerVolume"),l="true"===localStorage.getItem("playerMuted");o?(n.volumeSlider.value=o,n.video.volume=o):(n.volumeSlider.value=.5,n.video.volume=.5),n.video.muted=l,_(),document.addEventListener("keydown",e=>{if(document.activeElement!==n.urlInput)switch(e.key.toLowerCase()){case" ":e.preventDefault(),n.video.paused&&!s?n.video.play().then(()=>{T(i18n[a].statusSuccessPlay,"success")}).catch(e=>{T(i18n[a].statusErrorUnknown.replace("{msg}",e.message),"error")}):n.video.pause();break;case"arrowright":e.preventDefault(),n.video.currentTime=Math.min(n.video.currentTime+5,n.video.duration),n.progressBar.style.width=n.video.currentTime/n.video.duration*100+"%";break;case"arrowleft":e.preventDefault(),n.video.currentTime=Math.max(n.video.currentTime-5,0),n.progressBar.style.width=n.video.currentTime/n.video.duration*100+"%";break;case"arrowup":e.preventDefault();const t=Math.min(Number(n.video.volume)+.05,1);n.video.volume=t,n.volumeSlider.value=t;break;case"arrowdown":e.preventDefault();const o=Math.max(Number(n.video.volume)-.05,0);n.video.volume=o,n.volumeSlider.value=o;break;case"f":e.preventDefault(),U();break;case"p":e.preventDefault(),R();break;case"s":e.preventDefault(),P()}}),C(0,"info"),function(){let e=0;n.video.addEventListener("touchstart",t=>{const o=Date.now();o-e<300&&(t.preventDefault(),n.video.paused&&!s?n.video.play().then(()=>{T(i18n[a].statusSuccessPlay,"success")}).catch(e=>{T(i18n[a].statusErrorUnknown.replace("{msg}",e.message),"error")}):n.video.pause(),n.touchTip.classList.add("show"),clearTimeout(i),i=setTimeout(()=>{n.touchTip.classList.remove("show")},1e3)),e=o});let t=0,o=0;n.video.addEventListener("touchmove",e=>{if(1!==e.touches.length)return;const s=e.touches[0];if(0===t)return t=s.clientX,void(o=s.clientY);const l=s.clientX-t,r=s.clientY-o;if(Math.abs(l)>Math.abs(r)){e.preventDefault();const t=l/n.video.offsetWidth*n.video.duration;n.video.currentTime=Math.max(0,Math.min(n.video.currentTime+t,n.video.duration)),n.progressBar.style.width=n.video.currentTime/n.video.duration*100+"%"}else{e.preventDefault();const t=-r/n.video.offsetHeight,o=Math.max(0,Math.min(n.video.volume+t,1));n.video.volume=o,n.volumeSlider.value=o}t=s.clientX,o=s.clientY}),n.video.addEventListener("touchend",()=>{t=0,o=0}),C(0,"info")}(),J();const r=new URLSearchParams(window.location.search).get("url");let c="";if("/play"===window.location.pathname?r?(c=r,n.urlInput.value=c):c=n.urlInput.value.trim():r?(c=r.startsWith("web+video://")?r.replace(/^web\+video:\/\//,"https://"):r,C(0,"info"),n.urlInput.value=c):c=n.urlInput.value.trim(),c){j(c,await H()>0)}!localStorage.getItem("helpModalShown")&&n.helpModal&&setTimeout(()=>{n.helpModal.classList.add("show"),C(0,"info")},1e3);const d="https://rt-glb.rttv.com/dvr/rtnews/playlist_4500Kb.m3u8",m=localStorage.getItem("lastPlayedVideoUrl");m&&n.urlInput?(n.urlInput.value=m,C(0,"info")):n.urlInput&&(n.urlInput.value=d,C(0,"info")),await z(),n.historyBody&&n.historyBody.classList.add("show");const p=u();if(p){if(0===(await p.getAllRecords()).length){localStorage.getItem("hasAutoImported")||await async function(){try{const e=await fetch("/play-history-2026-01-17.m3u");if(!e.ok)throw new Error("文件不存在或无法访问");const t=(await e.text()).split("\n"),n=[];let o="";for(let c=0;c<t.length;c++){const e=t[c].trim();if(e.startsWith("#EXTINF:")){const t=e.split(",");t.length>1&&(o=t.slice(1).join(",").trim())}else e&&!e.startsWith("#")&&o&&e&&(n.push({url:e,title:o,date:(new Date).toISOString(),time:0,duration:0,playCount:1}),o="")}if(0===n.length)throw new Error("没有找到有效的播放历史记录");const s=document.getElementById("playlist-select"),l=`auto_imported_${Date.now()}`,r=`自动导入的播放列表_${(new Date).toISOString().slice(0,10)}`,i=document.createElement("option");i.value=l,i.textContent=r,s.appendChild(i);const a=JSON.parse(localStorage.getItem("playlists"))||[];a.push({id:l,name:r}),localStorage.setItem("playlists",JSON.stringify(a)),function(e,t){const n=indexedDB.open("PlaylistDB",1);n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("playlists")||t.createObjectStore("playlists",{keyPath:"id"})},n.onsuccess=n=>{const o=n.target.result,s=o.transaction("playlists","readwrite");s.objectStore("playlists").put({id:e,history:t}),s.oncomplete=()=>{o.close(),C(0,"success")},s.onerror=e=>{C(e.target.error,"error")}},n.onerror=e=>{C(e.target.error,"error")}}(l,n),C(n.length,"success"),localStorage.setItem("hasAutoImported","true")}catch(e){C(e.message,"info")}}()}}C(0,"success")};

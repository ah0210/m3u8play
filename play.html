<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title id="pageTitle">终极版 M3U8/MP4 播放器</title>
    
    <!-- SEO元标签 -->
    <meta name="description" content="一个功能强大的M3U8/MP4视频播放器，支持多种播放格式和自定义控制">
    <meta name="keywords" content="M3U8播放器,MP4播放器,视频播放器,在线播放器,HLS播放器">
    <meta name="author" content="Video Player">
    
    <!-- 性能优化 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    
    <!-- 引入外部样式文件 -->
    <link rel="stylesheet" href="./css/style.css">
    <!-- 使用轻量级的Font Awesome subset -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/fontawesome.min.css" crossorigin="anonymous" integrity="sha384-XOA6dDmLoJZqmmjRsAnPh1TWPmRmJtNW3PSHbgNTe+aIKxJbKunk7JBQ8Gf2p1c3" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/solid.min.css" crossorigin="anonymous" integrity="sha384-elnMAdx8pA8fVQgIsC4jK60s9eNxR8c5a3Yg4G4MfP+Mf0Kv100P6JEGTjXp1FyA" referrerpolicy="no-referrer">

    <!-- PWA支持 -->
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#4285f4">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="视频播放器">
    <link rel="apple-touch-icon" href="./icons/icon-192x192.png">
    <link rel="mask-icon" href="./icons/icon-maskable-192x192.png" color="#4285f4">
    <link rel="shortcut icon" href="./icons/icon-192x192.png">
    
    </head>
<body class="light">
    <div class="main-layout">
        <!-- 播放器区域 -->
        <div class="player-area">
            <div class="player-wrap">
                <!-- 视频区域 + 加载遮罩 + 触摸提示 -->
                <div class="video-container">
                    <video id="video-player"></video>
                    <div class="loading-mask" id="loading-mask">
                        <div class="spinner"></div>
                        <span id="loading-text">加载中...</span>
                    </div>
                    <div class="touch-tip" id="touch-tip">双击播放/暂停</div>
                    <div class="status-tip" id="status-tip"></div>
                    <!-- 侧边栏切换按钮 - 播放器内左上角 -->
                    <button class="sidebar-toggle" id="sidebar-toggle" title="切换历史记录">
                        <i class="fas fa-history"></i>
                    </button>
                </div>

                <!-- 自定义控制栏 -->
                <div class="custom-controls">
                    <!-- 第一行：链接输入 + 基础控制 + 语言/主题 -->
                    <div class="control-row">
                        <div class="url-input-wrapper">
                            <input type="text" id="url-input" placeholder="输入 m3u8/MP4 链接" 
                                   value="https://rt-glb.rttv.com/dvr/rtnews/playlist_4500Kb.m3u8">
                            <button type="button" id="url-clear-btn" class="url-clear-btn" title="清除">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <button class="control-btn" id="load-play-btn">
                            <i class="fas fa-play"></i> <span id="load-play-text">加载播放</span>
                        </button>
                        <button class="control-btn" id="pause-btn" disabled>
                            <i class="fas fa-pause"></i> <span>暂停</span>
                        </button>
                        <button class="control-btn" id="fullscreen-btn" disabled>
                            <i class="fas fa-expand"></i> <span>全屏</span>
                        </button>
                        <button class="control-btn" id="pip-btn" disabled>
                            <i class="fas fa-expand-arrows-alt"></i> <span>画中画</span>
                        </button>
                        <button class="control-btn" id="screenshot-btn" disabled>
                            <i class="fas fa-camera"></i> <span>截图</span>
                        </button>
                        <button class="control-btn" id="shortcut-btn">
                            <i class="fas fa-keyboard"></i> <span>快捷键</span>
                        </button>
                        <button class="control-btn" id="clear-cache-btn">
                            <i class="fas fa-trash"></i> <span>清理缓存</span>
                        </button>
                        <button class="control-btn" id="history-btn">
                            <i class="fas fa-history"></i> <span>播放历史</span>
                        </button>
                        
                        <!-- 语言选择 -->
                        <div class="control-group">
                            <span id="langLabel">语言</span>
                            <select class="select-control" id="lang-select">
                                <option value="zh-CN" selected>中文</option>
                                <option value="en-US">English</option>
                            </select>
                        </div>

                        <!-- 主题选择 -->
                        <div class="control-group">
                            <span id="themeLabel">主题</span>
                            <select class="select-control" id="theme-select">
                                <option value="light" selected>亮色</option>
                                <option value="dark">暗色</option>
                            </select>
                        </div>
                    </div>

                    <!-- 第二行：进度条 + 扩展控制 -->
                    <div class="control-row">
                        <!-- 进度条 -->
                        <div class="progress-wrap" id="progress-wrap">
                            <div class="progress-loaded" id="progress-loaded"></div>
                            <div class="progress-bar" id="progress-bar"></div>
                        </div>

                        <!-- 音量控制 -->
                        <div class="volume-wrap">
                            <i class="fas fa-volume-up" id="volume-icon"></i>
                            <input type="range" class="volume-slider" id="volume-slider" min="0" max="1" step="0.05" value="1">
                        </div>

                        <!-- 倍速选择 -->
                        <div class="control-group">
                            <span id="speedLabel">倍速</span>
                            <select class="select-control" id="speed-select">
                                <option value="0.5">0.5x</option>
                                <option value="0.75">0.75x</option>
                                <option value="1" selected>1x</option>
                                <option value="1.25">1.25x</option>
                                <option value="1.5">1.5x</option>
                                <option value="2">2x</option>
                            </select>
                        </div>

                        <!-- 画质选择（仅 m3u8 可用） -->
                        <div class="control-group">
                            <span id="qualityLabel">画质</span>
                            <select class="select-control" id="quality-select" disabled>
                                <option value="">自动</option>
                            </select>
                        </div>

                        <!-- 对齐方式选择 -->
                        <div class="control-group">
                            <span id="alignLabel">对齐</span>
                            <div class="align-controls">
                                <button class="align-btn" id="align-left" title="左对齐" data-align="left">
                                    <i class="fas fa-align-left"></i>
                                </button>
                                <button class="align-btn" id="align-center" title="居中对齐" data-align="center">
                                    <i class="fas fa-align-center"></i>
                                </button>
                                <button class="align-btn active" id="align-right" title="右对齐" data-align="right">
                                    <i class="fas fa-align-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 历史记录侧边栏 -->
        <div class="sidebar" id="sidebar">
            <div class="log-panel history-sidebar" id="history-panel">
                <div class="log-header" id="history-header">
                    <span id="historyTitle">播放历史</span>
                    <div class="history-header-actions">
                        <div class="sort-controls">
                    <span>排序：</span>
                    <button class="sort-btn active" id="sort-recent" data-sort="recent" data-text="最新">
                        <i class="fas fa-clock"></i>
                    </button>
                    <button class="sort-btn" id="sort-hot" data-sort="hot" data-text="热度">
                        <i class="fas fa-fire"></i>
                    </button>
                </div>
                <button class="log-clear" id="history-export" data-text="导出历史">
                    <i class="fas fa-download"></i>
                </button>
                <input type="file" id="history-import-input" accept=".json" style="display: none;">
                <button class="log-clear" id="history-import" data-text="导入历史">
                    <i class="fas fa-upload"></i>
                </button>
                <button class="log-clear" id="history-clear" data-text="清空历史">
                    <i class="fas fa-trash"></i>
                </button>
                    </div>
                </div>
                <div class="log-body" id="history-body">
                    <div class="history-empty" id="history-empty">暂无播放历史</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 截图预览弹窗 -->
    <div class="screenshot-modal" id="screenshot-modal">
        <div class="screenshot-content">
            <button class="screenshot-close" id="screenshot-close">×</button>
            <img src="" alt="视频截图" class="screenshot-img" id="screenshot-img">
            <button class="screenshot-download" id="screenshot-download">下载截图</button>
        </div>
    </div>

    <!-- 快捷键提示 -->
    <div class="shortcut-tip" id="shortcut-tip">
        <h4 id="shortcutTitle">快捷键说明</h4>
        <ul>
            <li><span class="key">空格</span><span id="shortcutPlay">播放/暂停</span></li>
            <li><span class="key">→</span><span id="shortcutForward">快进 5 秒</span></li>
            <li><span class="key">←</span><span id="shortcutBackward">后退 5 秒</span></li>
            <li><span class="key">↑</span><span id="shortcutVolUp">音量+5%</span></li>
            <li><span class="key">↓</span><span id="shortcutVolDown">音量-5%</span></li>
            <li><span class="key">F</span><span id="shortcutFullscreen">全屏/退出全屏</span></li>
            <li><span class="key">P</span><span id="shortcutPip">画中画/退出</span></li>
            <li><span class="key">S</span><span id="shortcutScreenshot">截图</span></li>
        </ul>
    </div>

    <!-- 日志面板 -->
    <div class="log-panel">
        <div class="log-header" id="log-header">
            <span id="logTitle">播放日志</span>
            <button class="log-clear" id="log-clear">清空日志</button>
        </div>
        <div class="log-body" id="log-body"></div>
    </div>

    <!-- 引入外部JavaScript文件 -->
    <script src="./js/storage.js"></script>
    <script src="./js/i18n.js"></script>
    <script src="./js/script.js"></script>
</body>
</html>